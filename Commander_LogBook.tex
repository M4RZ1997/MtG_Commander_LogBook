\documentclass{article}

\usepackage{data/datastyle}
\usepackage{stylesheets/shadowfy}
\usepackage{stylesheets/cmd_lb_stylesheet}
\usepackage{stylesheets/cmd_lb_commands}
\usepackage{stylesheets/cmd_lb_helpers}

\usepackage{stylesheets/cmd_lb_display_commands}

\geometry{a3paper, landscape}

\newfontfamily\titlefont{Planewalker-38m6}[Path=./fonts/, Extension=.ttf, UprightFont=Planewalker-38m6, BoldFont=PlanewalkerBold-xZj5, ItalicFont=PlanewalkerItalic-DgM1, BoldItalicFont=PlanewalkerBoldItalic-p4qr] % requires XeLaTeX or LuaTeX
\newfontfamily\MtGIcons{PlanewalkerDings-Pl9d}[Path=./fonts/, Extension=.ttf, UprightFont=PlanewalkerDings-Pl9d] % requires XeLaTeX or LuaTeX

\begin{document}
	% Data Input
	\input{data/commander_decklist.tex}
	\input{data/data_1v1.tex}
	\input{data/data_3player.tex}
	\input{data/data_4player.tex}
	
	\hypertarget{startofdocument}{}
	
	% Ornaments
	\begin{tikzpicture}[remember picture,overlay]%
		\WinLoseStatisticOrnamentOutline
		\colorMatchUpTurnNumberStatisticOrnamentOutline
		
		%\inDepthStatisticOrnamentOutline{623pt}{-220pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-220pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-445pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-445pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-670pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-670pt}
	\end{tikzpicture}%
	
	% First 28 ToC Entries
	{\Large%
	\begin{tikzpicture}[remember picture,overlay]%
		\node[xshift=-488pt,yshift=295pt, text width=620pt, anchor=north west] at (current page.center) {%
			\begin{minipage}[t][275pt]{620pt}
				\textcolor{white}{\Huge{\textbf{~~~~Table~~of~~Decks}}}
				\setlength{\columnsep}{30pt}\vspace*{-3pt}
				\begin{multicols}{2}
					\color{white}
					\renewcommand{\contentsname}{}
					\tableofcontents
					\thispagestyle{fancy}
				\end{multicols}
			\end{minipage}
		};%
	\end{tikzpicture}%
	}%
	
	% Second 12 ToC Entries
	{\Large%
	\begin{tikzpicture}[remember picture,overlay]%
		\node[xshift=-488pt,yshift=-163pt, text width=620pt, anchor=north west] at (current page.center) {%
			\begin{minipage}[t][275pt]{620pt}
				\setlength{\columnsep}{30pt}
				\begin{multicols}{2}
					\color{white}
					\listofsecondContents
					\thispagestyle{fancy}
				\end{multicols}
			\end{minipage}
		};%
		\node[xshift=-488pt,yshift=-323pt, text width=620pt, align=center, anchor=north west] at (current page.center) {%
			\color{lightgray} \textbf{This Table of Decks does support a total of 40 Decks}
		};%
	\end{tikzpicture}%
	}%
	
	% Side Frames
	\begin{tikzpicture}[remember picture,overlay]
		% M4RZ-Crafting Icon
		\node[xshift=767pt, yshift=-60pt] {%
			\includegraphics[width = 200pt, height = 200pt, keepaspectratio]{images/M4RZ-Crafting_icon.png}%
		};%
		
		% Latest Performance Information		
		\node[xshift=935pt, yshift=30pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}{\Large \textsc{Performance}}
		};
		\node[xshift=935pt, yshift=10pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, white, align=center] {%
			\begin{tikzpicture}
				\node[text width=125pt] {%
					{\large 1v1 Commander}\\\vspace*{0.3em}\calcPerformanceStatistic{LogBook1v1}
				};%
				\node[yshift=-55pt, text width=125pt] {%
					{\large 3 Player Commander}\\\vspace*{0.3em}\calcPerformanceStatistic{LogBook3Player}
				};%
				\node[yshift=-110pt, text width=125pt] {%
					{\large 4 Player Commander}\\\vspace*{0.3em}\calcPerformanceStatistic{LogBook4Player}
				};%
			\end{tikzpicture}
		};%
		
		% Most Tracked Deck
		\node[xshift=771.5pt, yshift=-195pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}{\large \textsc{Most Tracked Deck}}
		};
		\calcMostLeastTrackedDeck{<}		
		\node[xshift=771.5pt, yshift=-275pt, text width=136pt, inner sep=0pt, outer sep=0pt, align=center] {%
			\includegraphics[width = 136pt, height = 136pt, keepaspectratio]{images/deck_crests/\DeckImage.png}%
		};
		\node[xshift=771.5pt, yshift=-350pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}The most tracked deck is\linebreak\mlTrackedDeck\linebreak(\mlTimesTrackedNumber~Games tracked)\\
		};%
		
		% Least Tracked Deck
		\node[xshift=935pt, yshift=-195pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}{\large \textsc{Least Tracked Deck}}
		};
		\calcMostLeastTrackedDeck{>}		
		\node[xshift=935pt, yshift=-275pt, text width=136pt, inner sep=0pt, outer sep=0pt, align=center] {%
			\includegraphics[width = 136pt, height = 136pt, keepaspectratio]{images/deck_crests/\DeckImage.png}%
		};
		\node[xshift=935pt, yshift=-350pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}The least tracked deck is\linebreak\mlTrackedDeck\linebreak(\mlTimesTrackedNumber~Games tracked)\\
		};%
		
		% Deck Archetypes
		\node[xshift=771.5pt, yshift=-420pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}{\large \textsc{Deck Archetypes}}%
		};%
		\node[xshift=771.5pt, yshift=-442.5pt, text width=120pt, anchor=north, inner sep=0pt, outer sep=0pt, white] {%
			\printDeckArchetypeDistribution%
		};
		
		% Author Notes
		\node[xshift=935pt, yshift=-420pt, text width=136pt, anchor=north, inner sep=0pt, outer sep=0pt, align=center] {%
			\color{white}{\large \textsc{Author's Notes}}%
		};%
		\node[xshift=935pt, yshift=-427.5pt, text width=130pt, anchor=north, inner sep=0pt, outer sep=0pt, white] {%
			{\justify This logbook serves as a comprehensive tracker for Magic: The Gathering Commander decks, offering a detailed account of performance metrics and game statistics across an array of deck archetypes. It's designed to aid in the refinement and understanding of each deck's capabilities, providing insights into their successes and areas for improvement.}\\
			- M4RZ
		};
	\end{tikzpicture}
	
	\newpage
	\renewcommand{\fancypagestyleheader}{1v1 Commander Breakdown}
	\renewcommand{\linktotop}{T}
	\xdef\logbook{LogBook1v1}
	
	\begin{tikzpicture}[remember picture,overlay]%
		\WinLoseStatisticOrnamentOutline
		\colorMatchUpTurnNumberStatisticOrnamentOutline
		
		\inDepthStatisticOrnamentOutline{623pt}{-220pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-220pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-445pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-445pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-670pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-670pt}
	\end{tikzpicture}%
	
	% Win/Lose Statistic
	\calculateWinLosePercentage{\logbook}
	\frameWinLoseStatistic{\winpercentage}{\losepercentage}
	
	% Average Finish Position Statistic
	\begin{tikzpicture}
		\node {};
	\end{tikzpicture}
	
	% Color Match-Up OR Turn Number Statistic
	\calculateAverage{\logbook}{TurnNumber}
	\calculateMedian{\logbook}{TurnNumber}
	\calculateMinMax{\logbook}{TurnNumber}
	\frameTurnNumberStatistic{1}{0}{\minimum}{\maximum}{\lowerquartile}{\upperquartile}{}{\average}{\median}%
	
	% In-Depth Statistics
	\begin{tikzpicture}[remember picture,overlay]
		% Deck Banner OR Fast Mana to Win/Lose Frame
		%\frameDeckBanner{Adamantine_Flyers}%
		\calculateTwoPlayerFastManaWinLosePercentages{\logbook}%
		\frameFastManaToWinLoseStatistic{\fastmanawinpercentage}{\nofastmanawinpercentage}{\nofastmanalosepercentage}{\fastmanalosepercentage}%
	
		% Mulligan Reason OR Winners Start Position Frame
		\calculateTwoPlayerStartGameWinLosePercentage{\logbook}%
		\frameWinnerStartPositionStatistic{\startgamewinpercentage}{\startgamelosepercentage}{}{}%
		%\frameMulliganReasonsStatistic{15}{25}{30}{10}{20}{15}%
		
		% Win Condition Frame
		\calculateWinConditionsPercentages{\logbook}{WIN}%
		\frameWinConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Lose Condition Frame
		\calculateWinConditionsPercentages{\logbook}{LOSE}%
		\frameLoseConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Game Length Frame
		\calculateGameLengthsPercentages{\logbook}%
		\frameGameLengthStatistic{\shortgamepercentage}{\midgamepercentage}{\longgamepercentage}{\verylonggamepercentage}%
		
		% Obvious Problems Frame
		\calculateObviousProblemsPercentages{\logbook}
		\frameObviousProblemsStatistic{\manascrewpercentage}{\manafloodpercentage}{\carddrawpercentage}{\lackofresponsespercentage}{\highcmcpercentage}{\targetingpercentage}{\misplayspercentage}%
	\end{tikzpicture}
	
	\newpage
	\renewcommand{\fancypagestyleheader}{3 Player Commander Breakdown}
	\xdef\logbook{LogBook3Player}
	
	\begin{tikzpicture}[remember picture,overlay]%
		\WinLoseStatisticOrnamentOutline
		\colorMatchUpTurnNumberStatisticOrnamentOutline
		
		\inDepthStatisticOrnamentOutline{623pt}{-220pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-220pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-445pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-445pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-670pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-670pt}
	\end{tikzpicture}%
	
	% Win/Lose Statistic
	\calculateWinLosePercentage{\logbook}
	\frameWinLoseStatistic{\winpercentage}{\losepercentage}
	
	% Average Finish Position Statistic
	\calculateThreePlayerAverageFinishPositions{\logbook}
	\frameAverageFinishPositionStatistic{\averageSelfFinishPosition}{\averageFirstPlayerFinish}{\averageSecondPlayerFinish}{\averageThirdPlayerFinish}{}
	
	% Color Match-Up OR Turn Number Statistic
	\calculateAverage{\logbook}{TurnNumber}
	\calculateMedian{\logbook}{TurnNumber}
	\calculateMinMax{\logbook}{TurnNumber}
	\calculateFirstKillTurnAverage{\logbook}{FirstKillTurn}
	\frameTurnNumberStatistic{1}{0}{\minimum}{\maximum}{\lowerquartile}{\upperquartile}{\averageFirstKillTurnNumber}{\average}{\median}%
	
	% In-Depth Statistics
	\begin{tikzpicture}[remember picture,overlay]
		% Deck Banner OR Fast Mana to Win/Lose Frame
		%\frameDeckBanner{Adamantine_Flyers}%
		\calculateThreePlayerFastManaWinLosePercentages{\logbook}%
		\frameFastManaToWinLoseStatistic{\threeplayerfastmanawinpercentage}{\threeplayernofastmanawinpercentage}{\threeplayernofastmanalosepercentage}{\threeplayerfastmanalosepercentage}%
	
		% Mulligan Reason OR Winners Start Position Frame
		\calculateThreePlayerStartGameWinLosePercentage{\logbook}%
		\frameWinnerStartPositionStatistic{\threeplayerfirstwinpercentage}{\threeplayersecondwinpercentage}{\threeplayerthirdwinpercentage}{}%
		%\frameMulliganReasonsStatistic{15}{25}{30}{10}{20}{15}%
		
		% Win Condition Frame
		\calculateWinConditionsPercentages{\logbook}{WIN}%
		\frameWinConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Lose Condition Frame
		\calculateWinConditionsPercentages{\logbook}{LOSE}%
		\frameLoseConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Game Length Frame
		\calculateGameLengthsPercentages{\logbook}%
		\frameGameLengthStatistic{\shortgamepercentage}{\midgamepercentage}{\longgamepercentage}{\verylonggamepercentage}%
		
		% Obvious Problems Frame
		\calculateObviousProblemsPercentages{\logbook}
		\frameObviousProblemsStatistic{\manascrewpercentage}{\manafloodpercentage}{\carddrawpercentage}{\lackofresponsespercentage}{\highcmcpercentage}{\targetingpercentage}{\misplayspercentage}%
	\end{tikzpicture}
	
	\newpage
	\renewcommand{\fancypagestyleheader}{4 Player Commander Breakdown}
	\xdef\logbook{LogBook4Player}
	
	\begin{tikzpicture}[remember picture,overlay]%
		\WinLoseStatisticOrnamentOutline
		\colorMatchUpTurnNumberStatisticOrnamentOutline
		
		\inDepthStatisticOrnamentOutline{623pt}{-220pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-220pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-445pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-445pt}
		
		\inDepthStatisticOrnamentOutline{623pt}{-670pt}
		\inDepthStatisticOrnamentOutline{786.5pt}{-670pt}
	\end{tikzpicture}%
	
	% Win/Lose Statistic
	\calculateWinLosePercentage{\logbook}
	\frameWinLoseStatistic{\winpercentage}{\losepercentage}
	
	% Average Finish Position Statistic
	\calculateFourPlayerAverageFinishPositions{\logbook}
	\frameAverageFinishPositionStatistic{\averageSelfFinishPosition}{\averageFirstPlayerFinish}{\averageSecondPlayerFinish}{\averageThirdPlayerFinish}{\averageFourthPlayerFinish}
	
	% Color Match-Up OR Turn Number Statistic
	\calculateAverage{\logbook}{TurnNumber}
	\calculateMedian{\logbook}{TurnNumber}
	\calculateMinMax{\logbook}{TurnNumber}
	\calculateFirstKillTurnAverage{\logbook}{FirstKillTurn}
	\frameTurnNumberStatistic{1}{0}{\minimum}{\maximum}{\lowerquartile}{\upperquartile}{\averageFirstKillTurnNumber}{\average}{\median}%
	
	% In-Depth Statistics
	\begin{tikzpicture}[remember picture,overlay]
		% Deck Banner OR Fast Mana to Win/Lose Frame
		\calculateFourPlayerFastManaWinLosePercentages{\logbook}%
		\frameFastManaToWinLoseStatistic{\fourplayerfastmanawinpercentage}{\fourplayernofastmanawinpercentage}{\fourplayernofastmanalosepercentage}{\fourplayerfastmanalosepercentage}%
	
		% Mulligan Reason OR Winners Start Position Frame
		\calculateFourPlayerStartGameWinLosePercentage{\logbook}
		\frameWinnerStartPositionStatistic{\fourplayerfirstwinpercentage}{\fourplayersecondwinpercentage}{\fourplayerthirdwinpercentage}{\fourplayerfourthwinpercentage}%
		%\frameMulliganReasonsStatistic{15}{25}{30}{10}{20}{15}%
		
		% Win Condition Frame
		\calculateWinConditionsPercentages{\logbook}{WIN}%
		\frameWinConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Lose Condition Frame
		\calculateWinConditionsPercentages{\logbook}{LOSE}%
		\frameLoseConditionStatistic{\hpopercentage}{\poisonpercentage}{\deckoutpercentage}{\cardeffectpercentage}{\commanderdamagepercentage}%
		
		% Game Length Frame
		\calculateGameLengthsPercentages{\logbook}%
		\frameGameLengthStatistic{\shortgamepercentage}{\midgamepercentage}{\longgamepercentage}{\verylonggamepercentage}%
		
		% Obvious Problems Frame
		\calculateObviousProblemsPercentages{\logbook}
		\frameObviousProblemsStatistic{\manascrewpercentage}{\manafloodpercentage}{\carddrawpercentage}{\lackofresponsespercentage}{\highcmcpercentage}{\targetingpercentage}{\misplayspercentage}%
	\end{tikzpicture}
	
	\input{deck_information_pages/Commander_Information_Connector.tex}
\end{document}